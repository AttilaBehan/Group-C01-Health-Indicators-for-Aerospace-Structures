import pywt
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

# Load data
df = pd.read_csv(r"SP\LowLevelFeaturesSample1.csv")

# Assuming first column is time, second is signal
t = df.iloc[:, 0].values
signal = df.iloc[:, 1].values

# Define scales
scales = np.arange(1, 31)  # Adjust as needed

# Perform CWT using Gaussian wavelet
coef, freqs = pywt.cwt(signal, scales, 'morl')

# Plot the signal
plt.figure(figsize=(15, 4))
plt.plot(t, signal)
plt.title("Input Signal")
plt.xlabel("Time")
plt.ylabel("Amplitude")
plt.grid(True)
plt.tight_layout()
plt.show()

# Plot the scalogram
plt.figure(figsize=(15, 6))
plt.imshow(t, cmap='bone',
           aspect='auto', vmax=abs(coef).max(), vmin=-abs(coef).max())
plt.title("Continuous Wavelet Transform (Scalogram)")
plt.xlabel("Time")
plt.ylabel("Scale")
plt.colorbar(label="Magnitude")
plt.tight_layout()
plt.show()
